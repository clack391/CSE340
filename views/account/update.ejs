<section class="account-update">
  <%- messages() %>

  <h1><%= typeof title !== "undefined" ? title : "Update Account" %></h1>

  <% const accountRecord = typeof account !== "undefined" ? account : locals.accountData; %>

  <div class="account-update-forms">
    <form
      id="accountUpdateForm"
      class="card-form"
      action="/account/update"
      method="post"
    >
      <h2>Account Update</h2>

      <% if (errors) { %>
        <ul class="notice">
          <% errors.array().forEach(error => { %>
            <li><%= error.msg %></li>
          <% }) %>
        </ul>
      <% } %>

      <div class="form-field">
        <label for="account_firstname">First name</label>
        <input
          type="text"
          id="account_firstname"
          name="account_firstname"
          value="<%= typeof account_firstname !== "undefined" ? account_firstname : accountRecord?.account_firstname || "" %>"
          required
        >
      </div>

      <div class="form-field">
        <label for="account_lastname">Last name</label>
        <input
          type="text"
          id="account_lastname"
          name="account_lastname"
          value="<%= typeof account_lastname !== "undefined" ? account_lastname : accountRecord?.account_lastname || "" %>"
          required
        >
      </div>

      <div class="form-field">
        <label for="account_email">Email address</label>
        <input
          type="email"
          id="account_email"
          name="account_email"
          autocomplete="email"
          value="<%= typeof account_email !== "undefined" ? account_email : accountRecord?.account_email || "" %>"
          required
        >
      </div>

      <input type="hidden" name="account_id" value="<%= accountRecord?.account_id %>">

      <button class="btn btn-primary" type="submit">Update account</button>
    </form>

    <form
      id="accountPasswordForm"
      class="card-form"
      action="/account/update-password"
      method="post"
    >
      <h2>Change Password</h2>

      <% if (passwordErrors) { %>
        <ul class="notice">
          <% passwordErrors.array().forEach(error => { %>
            <li><%= error.msg %></li>
          <% }) %>
        </ul>
      <% } %>

      <p class="form-note">
        Entering a new password will replace your current password.
        Passwords must be at least 12 characters and include uppercase, lowercase, number, and special character.
      </p>

      <div class="form-field">
        <label for="account_password">New password</label>
        <input
          type="password"
          id="account_password"
          name="account_password"
          minlength="12"
          pattern="^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\\s).{12,}$"
          title="12+ characters with uppercase, lowercase, number, and special character"
          autocomplete="new-password"
          required
        >
      </div>

      <input type="hidden" name="account_id" value="<%= accountRecord?.account_id %>">

      <button class="btn btn-primary" type="submit">Change password</button>
    </form>
  </div>
</section>
